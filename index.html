<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="manifest" href="/component-library/manifest.json">
	<link rel="shortcut icon" href="">
	<meta charset="UTF-8">
	<title>Title</title>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
		  rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
</head>
<style>
	html, body {
		font-family: "Roboto", sans-serif;
		width: 100%;
		height: 100%;
		margin: 0;
		background-color: #dd2c00;
		color: white;
	}
	
	.tab-bar {
		width: 100%;
		height: 100%;
		
		/*background-color: white;*/
		
		display: flex;
		flex-direction: row;
		justify-content: space-between;
	}
	
	.tab-bar-item {
		flex: 1 1 0;
		display: flex;
		flex-direction: row;
		justify-content: center;
		align-content: center;
	}
	
	.tab-bar-item-icon {
		align-self: center;
		height: fit-content;
		width: fit-content;
		
		fill: black;
		stroke-dashoffset: 50%;
	}
	
	
	body {
		display: flex;
		flex-direction: column;
		justify-content: space-between;
	}
	
	.footer {
		width: 100%;
		height: 6.5%;
	}
	
	.tab-bar-item.childSelected {
		opacity: 0;
		transition: opacity 0s;
		stroke-dasharray: 0, 25;
		margin-top: -60px;
	}
	
	.tab-bar-item {
		opacity: 1;
		stroke-dasharray: 25, 0;
		margin-top: 0;
		transition: opacity 0.5s, stroke-dasharray 1s, margin-top 0.5s;
	}
	
	.tab-bar-item-svg.selectedNewPre.selectedNew {
		stroke-dasharray: 25, 0;
		opacity: 1;
		margin-top: 0;
	}
	
	.tab-bar-item-svg.selectedNewPre {
		transition: stroke-dasharray 1s ease 0.5s, opacity 0.5s, margin-top 0.5s;
		stroke-dasharray: 0, 25;
		opacity: 0;
		margin-top: 60px;
	}
	
	.tab-bar-item-svg {
		max-height: 70%;
		min-height: 70%;
		stroke: black;
		stroke-width: 2px;
		stroke-linejoin: round;
		fill: none;
	}
</style>

<style>
	.card {
		width: 100%;
		height: 100%;
	}
	
	.card-header {
		width: 100%;
		height: 6.5%;
		display: flex;
		flex-direction: row;
		justify-content: center;
		align-items: center;
		
		background-color: white;
		color: black;
		box-shadow: 0px 2px 14px 0px rgba(0, 0, 0, 0.42);
	}
	
	.card-header-title {
		margin-left: 5px;
		font-size: 5vh;
	}
	.card-content {
		padding: 10px;
		line-height: 1.5em;
	}

</style>
<!-- Card -->
<body>
<div class="card">
	<div class="card-header">
		<div class="card-header-title">
			Some
		</div>
	</div>
	<div class="card-content">
		<p class="sampleContent">
			Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et
			dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet
			clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet,
			consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat,
			sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no
			sea takimata sanctus est Lorem ipsum dolor sit amet.
		</p>
	</div>
</div>

<div class="footer">
	<div class="tab-bar">
	</div>
</div>

<script>
	let t_id = 0;
	const cards = [];
	// api
	
	const tabBarItemTemplate = (icon) => `
	<div class="tab-bar-item">
		<div class="tab-bar-item-icon">
			<svg xmlns="http://www.w3.org/2000/svg" height="100%" class="tab-bar-item-svg" viewBox="0 0 48 48">
				<text x="0" y="48" style="font-size: 48px" class="material-icons">${icon}</text>
			</svg>
		</div>
	</div>
	`;
	const tabBar = document.getElementsByClassName('tab-bar')[0];
	const cardTitle = document.getElementsByClassName('card-header-title')[0];
	const setTitle = (title) => {
		cardTitle.innerHTML = title;
	};
	
	const addCard = (title, icon) => {
		cards.push({id: t_id, title, icon});
		tabBar.insertAdjacentElement('beforeend', (new DOMParser).parseFromString(tabBarItemTemplate(icon), 'text/html').body.firstElementChild);
		tabBar.lastElementChild.addEventListener('click', ($event) => onTabItemClick($event, t_id++));
	};
	
	
	// tab bar
	const removeSelected = () => {
		return Array.from(document.getElementsByClassName('selected')).forEach(el => {
			Array.from(document.getElementsByClassName('childSelected')).forEach(e => e.classList.remove('childSelected'));
			return el.classList.remove('selected');
		});
	};
	
	//			svg has same pos and size like tabBarDom Move to left lower corner to l_u_c to item l_u_c
	const pathTemplate = (tabBarDOMRect, itemDOMRect) => ` <path fill='white'  d='M0 ${tabBarDOMRect.height} V 0 H ${itemDOMRect.left - tabBarDOMRect.left - itemDOMRect.width * 1.5} C ${(itemDOMRect.left - tabBarDOMRect.left)} 0, ${(itemDOMRect.left - tabBarDOMRect.left) - 0.5 * itemDOMRect.width} ${itemDOMRect.height / 1.5},${(itemDOMRect.left - tabBarDOMRect.left) + itemDOMRect.width / 2} ${itemDOMRect.height / 1.5} C ${(itemDOMRect.left - tabBarDOMRect.left + itemDOMRect.width * 1.5)} ${itemDOMRect.height / 1.5},${itemDOMRect.left - tabBarDOMRect.left + itemDOMRect.width * 1} 0, ${itemDOMRect.left - tabBarDOMRect.left + itemDOMRect.width * 2.5} 0 H ${tabBarDOMRect.width} V ${tabBarDOMRect.height} Z	'/>`;
	const svgTemplate = (tabBarDOMRect, itemDOMRect) => `"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='${tabBarDOMRect.width}' height='${tabBarDOMRect.height}'>${pathTemplate(tabBarDOMRect, itemDOMRect)}</svg>"`;
	
	const style = document.createElement('style');
	style.type = 'text/css';
	style.innerHTML = '.bg {}';
	document.getElementsByTagName('head')[0].appendChild(style);
	let toDel;
	const onTabItemClick = ($event, id) => {
		setTitle(cards[id].title);
		if (toDel)
			toDel.remove();
		removeSelected();
		
		let svg = $event.currentTarget.firstElementChild.firstElementChild;
		const newSvg = svg.parentNode.parentNode.cloneNode(true);
		
		svg.classList.add('selected');
		style.innerHTML = `.bg{ background-image: url(${svgTemplate(tabBar.getBoundingClientRect(), $event.currentTarget.firstElementChild.getBoundingClientRect())}); }`;
		$event.currentTarget.classList.add('childSelected');
		tabBar.classList.add('bg');
		
		let boundingClientRect = svg.parentNode.getBoundingClientRect();
		toDel = newSvg;
		newSvg.classList.add('s');
		newSvg.style.position = 'absolute';
		newSvg.firstElementChild.firstElementChild.style.stroke = '#dd2c00';
		newSvg.firstElementChild.firstElementChild.style.strokeWidth = '2px';
		newSvg.firstElementChild.firstElementChild.style.borderRadius = '100%';
		newSvg.firstElementChild.firstElementChild.style.backgroundColor = 'white';
		newSvg.firstElementChild.firstElementChild.style.padding = '10px';
		newSvg.firstElementChild.firstElementChild.classList.add('selectedNewPre');
		newSvg.style.top = `${boundingClientRect.top - (boundingClientRect.height * 1.5) / 2}px`;
		newSvg.style.left = `${boundingClientRect.left + 5 - (boundingClientRect.width * 0.25)}px`;
		
		let number = boundingClientRect.width * 1.5;
		newSvg.style.width = `calc(${number}px - 10px)`;
		newSvg.style.height = `calc(${number}px - 10px)`;
		tabBar.appendChild(newSvg);
		
		setTimeout(() => {
			newSvg.firstElementChild.firstElementChild.classList.add('selectedNew');
		}, 10);
		
	};
	[
		{
			icon: 'edit',
			title: 'Edit Something'
		},
		{
			icon: 'list',
			title: 'News Feed'
		},
		{
			icon: 'home',
			title: 'Home'
		},
		{
			icon: 'person',
			title: 'Profile'
		},
		{
			icon: 'settings',
			title: 'Settings'
		}
	].forEach(card => addCard(card.title, card.icon));
	onTabItemClick({currentTarget: tabBar.firstElementChild.nextElementSibling}, 1);

</script>
</body>
</html>
